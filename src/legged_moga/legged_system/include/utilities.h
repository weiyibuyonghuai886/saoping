#pragma once
#include "Types.h"

#include "std_msgs/msg/float64_multi_array.hpp"
#include <deque>

namespace legged {

// using namespace ocs2;

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// 移动平均滤波器类
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
class MovingAverageFilter {
public:
    // 带参数构造函数
    MovingAverageFilter(size_t sample_count);

    // 应用滤波并返回滤波后的值
    double applyFilter(double new_value);

    // 重置滤波器
    void reset();

    // 获取当前滤波值
    double getCurrentValue() const;

private:
    size_t sample_count_;
    std::deque<double> samples_;
    double sum_;
};

// 便捷函数：应用移动平均滤波
double applyMovingAverageFilter(double value, MovingAverageFilter& filter);

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// 便捷函数实现
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
std_msgs::msg::Float64MultiArray createFloat64MultiArrayFromVector(const vector_t& data);

}